properties([
        parameters([
                gitParameter(name: 'CI_SCRIPTS',
                        branchFilter: 'origin/(.*)',
                        defaultValue: 'master',
                        type: 'PT_BRANCH',
                        useRepository: '.*jenkins\\-iac\\-ci.git',
                        description: 'CI support scripts location'
                ),
                gitParameter(name: 'SELENIUM',
                        branchFilter: 'origin/(.*)',
                        defaultValue: 'master',
                        type: 'PT_BRANCH',
                        useRepository: '.*selenium.*',
                        description: 'Integration tests'
                ),
        ])
])

node('docker-agent') {

    stage('Up environment') {
        checkout([
                $class: 'GitSCM',
                branches: [[name: CI_SCRIPTS]],
                extensions: [[$class: 'RelativeTargetDirectory', relativeTargetDir: 'infrastructure']],
                userRemoteConfigs: [[url: 'https://github.com/ehabibov/jenkins-iac-ci.git']]
        ])
        checkout([
                $class: 'GitSCM',
                branches: [[name: SELENIUM]],
                extensions: [[$class: 'RelativeTargetDirectory', relativeTargetDir: 'integration']],
                userRemoteConfigs: [[url: 'https://github.com/ehabibov/selenium-testng.git']]
        ])
    }
}